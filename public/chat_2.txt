# 01-Cleanup.ps1
Import-Module ActiveDirectory

$domainDN = "DC=ad,DC=musclehustle,DC=net"
$whatIf = $true  # set $false to actually delete

$users = @(
  @{ Department="Administration"; Name="Rachel Alvarez";   Username="rachelacmo" }
  @{ Department="Administration"; Name="Angela Foster";    Username="angelaftchro" }
  @{ Department="Administration"; Name="Larry Crossley";   Username="larrycrossleycoo" }
  @{ Department="Administration"; Name="Daniel Wright";    Username="danielwcfo" }
  @{ Department="Management";     Name="Mark Patel";       Username="markpdof" }
  @{ Department="Management";     Name="Sophia Martinez";  Username="sophiampm" }
  @{ Department="Management";     Name="Johnathan Peters"; Username="johnathanpgm" }
  @{ Department="Management";     Name="Olivia Sanchez";   Username="oliviasgm" }
  @{ Department="Management";     Name="Daniel Foster";    Username="danielfmd" }
  @{ Department="Management";     Name="Preston Peters";   Username="prestonpvpit" }
  @{ Department="Management";     Name="James Carter";     Username="jamescdota" }
  @{ Department="Management";     Name="Hannah Kim";       Username="hannahtkdm" }
  @{ Department="Management";     Name="Brett Pyle";       Username="brettpfm" }
  @{ Department="Management";     Name="Sasha Conner";     Username="sashacam" }
  @{ Department="Management";     Name="Pete Lyle";        Username="petelfm" }
  @{ Department="Management";     Name="Catherine Mallow"; Username="catherinemas" }
  @{ Department="IT";             Name="Priya Desai";      Username="priyadd" }
  @{ Department="IT";             Name="Ryan Matthews";    Username="ryanmsa" }
  @{ Department="IT";             Name="James Parker";     Username="jamespne" }
  @{ Department="TrainingAndNutrition"; Name="Ashley Carter";   Username="ashleycpt" }
  @{ Department="TrainingAndNutrition"; Name="Brooks Smith";    Username="brookssn" }
  @{ Department="TrainingAndNutrition"; Name="Hannah Thompson"; Username="hannahtpt" }
  @{ Department="TrainingAndNutrition"; Name="Bradley Scott";   Username="bradleysn" }
  @{ Department="CustomerService"; Name="Chloe Ngyuen";   Username="chloenfd" }
  @{ Department="CustomerService"; Name="Tyler Jackson";  Username="tylerjfd" }
  @{ Department="CustomerService"; Name="Sophia Fielder"; Username="sophiaffd" }
  @{ Department="CustomerService"; Name="Anthony Clark";  Username="anthonycfd" }
  @{ Department="SalesAndMarketing"; Name="Kevin Brooks";  Username="kevinbdobc" }
  @{ Department="SalesAndMarketing"; Name="Olivia Chen";   Username="oliviachendmm" }
  @{ Department="SalesAndMarketing"; Name="Tyler Johnson"; Username="tylerjcd" }
  @{ Department="Maintenance"; Name="Conner O'Conner"; Username="conneromt" }
  @{ Department="Maintenance"; Name="Diego Torres";    Username="diegotmt" }
)

foreach ($u in $users) {
  $acct = Get-ADUser -Filter "SamAccountName -eq '$($u.Username)'" `
    -Properties DistinguishedName -ErrorAction SilentlyContinue
  if (-not $acct) {
    Write-Host "Not found: $($u.Username)"
    continue
  }

  $expected = "*,OU=$($u.Department),$domainDN"
  if ($acct.DistinguishedName -like $expected) {
    Write-Host "Removing $($u.Username) in $($u.Department)"
    Remove-ADUser -Identity $acct -Confirm:$false -WhatIf:$whatIf
  } else {
    Write-Warning ("Skip {0}: not in OU {1}" -f $u.Username, $u.Department)
  }
}